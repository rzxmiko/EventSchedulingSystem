<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Event Scheduling System</title>
    <style>
        body { font-family: sans-serif; margin: 40px; background-color: #f4f4f9; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background-color: #007bff; color: white; }
        .form-section { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        input { padding: 8px; margin-right: 10px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 8px 15px; cursor: pointer; border: none; border-radius: 4px; background: #28a745; color: white; }
        button.delete { background: #dc3545; }
        button:hover { opacity: 0.8; }
    </style>
</head>
<body>

<h2>ðŸ“… Event Scheduling System</h2>

<div class="form-section">
    <h3>Create New Event</h3>
    <input type="text" id="title" placeholder="Event Title">
    <input type="number" id="price" placeholder="Price">
    <input type="number" id="orgId" placeholder="Organizer ID">
    <button onclick="addNewEvent()">Add Event</button>
</div>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Price</th>
        <th>Organizer ID</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody id="eventBody"></tbody>
</table>

<script>
    const API = "/api/events";

    async function loadEvents() {
        const res = await fetch(API);
        const events = await res.json();
        const tbody = document.getElementById('eventBody');
        tbody.innerHTML = '';

        events.forEach(event => {
            tbody.innerHTML += `
                    <tr>
                        <td>${event.id}</td>
                        <td>${event.title}</td>
                        <td>${event.price}</td>
                        <td>${event.organizer ? event.organizer.id : 'N/A'}</td>
                        <td>
                            <button class="delete" onclick="deleteEvent(${event.id})">Delete</button>
                        </td>
                    </tr>
                `;
        });
    }

    async function addNewEvent() {
        const title = document.getElementById('title').value;
        const price = document.getElementById('price').value;
        const orgId = document.getElementById('orgId').value;

        if (!title || !price || !orgId) {
            alert("Please fill all fields!");
            return;
        }

        const payload = {
            title: title,
            price: parseFloat(price),
            organizer: { id: parseInt(orgId) }
        };

        const res = await fetch(API, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        if (res.ok) {
            loadEvents();
            document.getElementById('title').value = '';
            document.getElementById('price').value = '';
            document.getElementById('orgId').value = '';
        } else {
            alert("Error! Check if Organizer ID exists.");
        }
    }

    async function deleteEvent(id) {
        if (confirm("Are you sure?")) {
            await fetch(`${API}/${id}`, { method: 'DELETE' });
            loadEvents();
        }
    }

    loadEvents();
</script>
</body>
</html>